<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:replace="~{layout/admin_layout :: head('Admin')}"></head>
<body>
<header th:replace="~{layout/admin_layout:: header()}"></header>
<div class="d-flex">
  <nav th:replace="~{layout/admin_layout :: nav()}"></nav>
  <div class="container mt-4">
    <h3 class="fw-bold text-primary mb-3">Thêm chuyến đi</h3>

    <form th:action="@{/admin/tour/save}" th:object="${tour}" method="post" enctype="multipart/form-data"
          class="shadow p-4 rounded bg-light">

      <div class="row g-3">
        <div class="col-md-6">
          <label class="form-label fw-bold">Tiêu đề</label>
          <input type="text" th:field="*{tieuDe}" class="form-control" required>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">Giá cả</label>
          <input type="text" th:field="*{gia}" class="form-control" required>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-bold">Ngày khởi hành</label>
          <input type="date" th:field="*{ngayKhoiHanh}" class="form-control" required>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-bold">Ngày kết thúc</label>
          <input type="date" th:field="*{ngayKetThuc}" class="form-control" required>
        </div>

        <div class="col-md-4">
          <label class="form-label">Phương tiện</label>
          <select class="form-select"
                  th:field="*{idPhuongTien.id}">
            <option th:each="pt : ${phuongTienList}"
                    th:value="${pt.id}"
                    th:text="${pt.loai}">
            </option>
          </select>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-bold">Châu lục</label>
          <select id="chauLuc" class="form-select">
            <option value="">-- Chọn châu lục --</option>
            <option th:each="c : ${chauLucList}"
                    th:value="${c}"
                    th:text="${c}">
            </option>
          </select>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-bold">Quốc gia</label>
          <select id="quocGia" class="form-select">
            <option value="">-- Chọn quốc gia --</option>
          </select>
        </div>

        <div class="col-md-4">
          <label class="form-label fw-bold">Thành phố</label>
          <select id="thanhPho"
                  class="form-select"
                  th:field="*{idDiemDen.id}">
            <option value="">-- Chọn thành phố --</option>
          </select>
        </div>

        <div class="col-md-6">
          <label>Nổi bật:</label><br>
          <input type="radio" th:field="*{noiBat}" th:value="true" id="yes">
          <label for="yes">Yes</label>

          <input type="radio" th:field="*{noiBat}" th:value="false" id="no">
          <label for="no">No</label>
        </div>

        <div class="col-md-12">
          <label class="form-label fw-bold">Mô tả</label>
          <textarea th:field="*{moTa}" class="form-control" rows="4" required></textarea>
        </div>

        <div class="col-md-12">
          <label class="form-label fw-bold">Highlight</label>
          <textarea th:field="*{highlight}" class="form-control" rows="4" required></textarea>
        </div>

        <div class="col-md-6">
          <label class="form-label fw-bold">Ảnh đại diện</label>
          <input type="file" name="file" class="form-control" accept="image/*">
        </div>

        <div class="col-12 text-end mt-3">
          <button type="submit" class="btn btn-success me-2">
            <i class="bi bi-save"></i> Lưu
          </button>
          <a th:href="@{/admin/tour}" class="btn btn-outline-secondary">
            <i class="bi bi-x-circle"></i> Hủy
          </a>
        </div>
      </div>
    </form>
  </div>
</div>
<script>
  document.getElementById("chauLuc").addEventListener("change", function () {
    fetch(`/api/dia-diem/quoc-gia?chauLuc=${this.value}`)
            .then(res => res.json())
            .then(data => {
              const qg = document.getElementById("quocGia");
              qg.innerHTML = '<option value="">-- Chọn quốc gia --</option>';
              document.getElementById("thanhPho").innerHTML =
                      '<option value="">-- Chọn thành phố --</option>';
              data.forEach(item => {
                qg.innerHTML += `<option value="${item}">${item}</option>`;
              });
            });
  });

  document.getElementById("quocGia").addEventListener("change", function () {
    fetch(`/api/dia-diem/thanh-pho?quocGia=${this.value}`)
            .then(res => res.json())
            .then(data => {
              const tp = document.getElementById("thanhPho");
              tp.innerHTML = '<option value="">-- Chọn thành phố --</option>';
              data.forEach(item => {
                tp.innerHTML += `<option value="${item.id}">${item.thanhPho}</option>`;
              });
            });
  });
</script>

</body>
</html>
